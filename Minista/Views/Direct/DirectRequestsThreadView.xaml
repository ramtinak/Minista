<Page
    x:Class="Minista.Views.Direct.DirectRequestsThreadView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:converters="using:Minista.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:gif="using:XamlAnimatedGif"
    xmlns:loading="using:Minista.UserControls"
    xmlns:local="using:Minista.Views.Direct"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:selector="using:Minista.Selectors"
    xmlns:vm="using:Minista.ViewModels.Direct"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    NavigationCacheMode="Enabled"
    mc:Ignorable="d">
    <Page.DataContext>
        <vm:DirectRequestsThreadViewModel x:Name="DirectRequestsThreadVM" />
    </Page.DataContext>
    <Page.Resources>
        <ResourceDictionary>
            <Style x:Key="GridViewItemContainerStyle" TargetType="GridViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                <Setter Property="VerticalAlignment" Value="Stretch" />
                <Setter Property="Margin" Value="1" />
                <Setter Property="Padding" Value="0" />
            </Style>

            <converters:DirectItemHorizontalConverter x:Name="DirectItemHorizontalConverter" />
            <converters:StoryShareTitleConverter x:Name="StoryShareTitleConverter" />
            <converters:MediaTypeConverter x:Name="MediaTypeConverter" />
            <converters:ReelShareConverter x:Name="ReelShareConverter" />
            <converters:NullableToVisibilityConverter x:Name="NullableToVisibilityConverter" />
            <converters:DirectLinkImageConverter x:Name="DirectLinkImageConverter" />
            <converters:NumericToSeparatorConverter x:Name="NumericToSeparatorConverter" />
            <converters:AddHashtagToStringConverter x:Name="AddHashtagToStringConverter" />
            <converters:StringToUriConverter x:Name="StringToUriConverter" />
            <converters:DirectMediaShareConverter x:Name="DirectMediaShareConverter" />
            <converters:DoubleToVisibilityConverter x:Name="DoubleToVisibilityConverter" />
            <converters:DirectItemUserVisibilityConverter x:Name="DirectItemUserVisibilityConverter" />
            <converters:DirectItemUserProfilePictureConverter x:Name="DirectItemUserProfilePictureConverter" />
            <converters:ThreadItemBackgroundColorConverter x:Name="ThreadItemBackgroundColorConverter" />

            <selector:ThreadItemTemplateSelector
                x:Key="ThreadItemTemplateSelector"
                ActionLogTemplate="{StaticResource ActionLogTemplate}"
                AnimatedMediaTemplate="{StaticResource AnimatedMediaTemplate}"
                EmptyReelShareMediaTemplate="{StaticResource EmptyReelShareMediaTemplate}"
                EmptyStoryShareTemplate="{StaticResource EmptyStoryShareTemplate}"
                FelixShareTemplate="{StaticResource FelixShareTemplate}"
                HashtagMediaTemplate="{StaticResource HashtagMediaTemplate}"
                LikeTemplate="{StaticResource LikeTemplate}"
                LinkMediaTemplate="{StaticResource LinkMediaTemplate}"
                LiveViewerInviteTemplate="{StaticResource LiveViewerInviteTemplate}"
                LocationMediaTemplate="{StaticResource LocationMediaTemplate}"
                MediaShareTemplate="{StaticResource MediaShareTemplate}"
                MediaTemplate="{StaticResource MediaTemplate}"
                NoTemplate="{StaticResource NoTemplate}"
                NotSupportedTemplate="{StaticResource NotSupportedTemplate}"
                PlaceholderTemplate="{StaticResource PlaceholderTemplate}"
                ProfileTemplate="{StaticResource ProfileTemplate}"
                RavenMediaTemplate="{StaticResource RavenMediaTemplate}"
                ReelShareMediaTemplate="{StaticResource ReelShareMediaTemplate}"
                StoryShareTemplate="{StaticResource StoryShareTemplate}"
                TextTemplate="{StaticResource TextTemplate}"
                VideoCallEventTemplate="{StaticResource VideoCallEventTemplate}"
                VoiceMediaTemplate="{StaticResource VoiceMediaTemplate}" />

            <DataTemplate x:Key="LikeTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderThickness="1"
                            CornerRadius="25">

                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="35"
                                Foreground="#FFCDCDCD"
                                Text="{Binding Text}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="StoryShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            Height="360"
                            MinWidth="240"
                            MinHeight="50"
                            MaxWidth="340"
                            Margin="5"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Converter={StaticResource StoryShareTitleConverter}}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <controls:ImageEx
                                Grid.Row="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch">
                                <controls:ImageEx.Background>
                                    <ImageBrush Stretch="Fill">
                                        <ImageBrush.ImageSource>
                                            <BitmapImage UriSource="{Binding StoryShare.Media.Images[0].Uri}" />
                                        </ImageBrush.ImageSource>
                                    </ImageBrush>
                                </controls:ImageEx.Background>
                            </controls:ImageEx>
                            <Grid
                                Grid.RowSpan="2"
                                Background="Cyan"
                                DataContext="{Binding}"
                                Opacity="0"
                                Tapped="StoryShareGridTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="EmptyStoryShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding StoryShare.Title}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding StoryShare.Message}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="#FFCDCDCD"
                                Text="{Binding}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NoTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">

                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="#FFCDCDCD"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NotSupportedTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            Background="#FF1D1C1C"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="White"
                                Text="This type of message is not supported yet"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="PlaceholderTemplate">
                <Grid IsHoldingEnabled="True" IsRightTapEnabled="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Placeholder.Title}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Placeholder.Message}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="#FFCDCDCD"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </Grid>

            </DataTemplate>
            <DataTemplate x:Key="TextTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="320"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="MediaShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Caption" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="#FF252525"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="60" Margin="5,0,5,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="3" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Ellipse
                                Grid.Column="0"
                                Width="45"
                                Height="45"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                StrokeThickness="0">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding MediaShare.User.ProfilePicture}" />
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock
                                Grid.Column="2"
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                Text="{Binding MediaShare.User.UserName}" />


                        </Grid>
                        <controls:ImageEx
                            Grid.Row="1"
                            MinHeight="90"
                            Stretch="Uniform"
                            Tapped="MediaShareImageExTapped">
                            <controls:ImageEx.Source>
                                <BitmapImage UriSource="{Binding MediaShare, Converter={StaticResource DirectMediaShareConverter}}" />
                            </controls:ImageEx.Source>
                        </controls:ImageEx>
                        <Grid Grid.Row="2" MaxHeight="65">
                            <TextBlock
                                Grid.Column="2"
                                Margin="5,2"
                                DataContext="{Binding MediaShare.Caption.Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}" />
                        </Grid>
                    </Grid>
                </Grid>

            </DataTemplate>
            <DataTemplate x:Key="MediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <!--
                        Height="400"
                        Width="290"
                    -->
                    <Grid
                        Grid.Column="1"
                        MaxWidth="290"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="#FF252525"
                        BorderThickness="1"
                        CornerRadius="15">
                        <controls:ImageEx MinHeight="90" Stretch="Uniform">
                            <controls:ImageEx.Source>
                                <BitmapImage UriSource="{Binding Media.Images[0].Uri}" />
                            </controls:ImageEx.Source>
                        </controls:ImageEx>
                        <ProgressBar
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="#4DFFFFFF"
                            Foreground="#B6292828"
                            Maximum="100"
                            RenderTransformOrigin="0.5,0.5"
                            Visibility="{Binding Media.Percentage, Converter={StaticResource DoubleToVisibilityConverter}}"
                            Value="{Binding Media.Percentage}">
                            <ProgressBar.RenderTransform>
                                <CompositeTransform Rotation="-90" />
                            </ProgressBar.RenderTransform>
                        </ProgressBar>
                        <ProgressRing
                            Width="85"
                            Height="85"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="#D8575757"
                            IsActive="True"
                            Visibility="{Binding Media.Percentage, Converter={StaticResource DoubleToVisibilityConverter}}" />
                        <Grid
                            Background="DodgerBlue"
                            Opacity="0"
                            Tapped="MediaImageExTapped" />
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="ProfileTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Profile" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        Width="205.5"
                        MaxHeight="182"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="#FF252525"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="60" Margin="5,0,5,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="3" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Ellipse
                                Grid.Column="0"
                                Width="45"
                                Height="45"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                StrokeThickness="0">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding ProfileMedia.ProfilePicture}" />
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock
                                Grid.Column="2"
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                Text="{Binding ProfileMedia.UserName}" />


                        </Grid>
                        <GridView
                            Grid.Row="1"
                            IsItemClickEnabled="False"
                            ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                            ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                            ItemsSource="{Binding PreviewMedias}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.HorizontalScrollMode="Disabled"
                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid
                            Grid.RowSpan="3"
                            Background="AliceBlue"
                            Opacity="0"
                            Tapped="ProfileGridTapped" />
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="FelixShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Caption" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MaxWidth="300"
                            Margin="5"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <controls:ImageEx
                                Grid.Row="1"
                                MinHeight="90"
                                Stretch="Uniform">
                                <controls:ImageEx.Source>
                                    <BitmapImage UriSource="{Binding FelixShareMedia.Images[0].Uri}" />
                                </controls:ImageEx.Source>
                            </controls:ImageEx>
                            <Grid VerticalAlignment="Bottom">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" MaxHeight="75" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <controls:DropShadowPanel
                                    Margin="15,2"
                                    BlurRadius="15.0"
                                    OffsetX="5.0"
                                    OffsetY="5.0"
                                    ShadowOpacity="0.70"
                                    Color="Black">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="White"
                                        Text="{Binding FelixShareMedia.Title}"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />

                                </controls:DropShadowPanel>


                                <Grid
                                    Grid.Row="1"
                                    Height="60"
                                    Margin="5,0,5,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50" />
                                        <ColumnDefinition Width="3" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Ellipse
                                        Grid.Column="0"
                                        Width="45"
                                        Height="45"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        StrokeThickness="0">
                                        <Ellipse.Fill>
                                            <ImageBrush ImageSource="{Binding FelixShareMedia.User.ProfilePicture}" />
                                        </Ellipse.Fill>
                                    </Ellipse>
                                    <controls:DropShadowPanel
                                        Grid.Column="2"
                                        BlurRadius="15.0"
                                        OffsetX="5.0"
                                        OffsetY="5.0"
                                        ShadowOpacity="0.70"
                                        Color="Black">
                                        <TextBlock
                                            Margin="0,8,0,8"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource VazirFont}"
                                            FontSize="{StaticResource TinyFontSize}"
                                            Foreground="White"
                                            Text="{Binding FelixShareMedia.User.UserName}" />
                                    </controls:DropShadowPanel>

                                </Grid>

                            </Grid>

                            <Grid
                                Grid.RowSpan="4"
                                Background="AliceBlue"
                                Opacity="0"
                                Tapped="FelixShareGridTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="RavenMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="45"
                            MaxWidth="360"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="#FF252525"
                            BorderThickness="1.5"
                            CornerRadius="25">
                            <TextBlock
                                Margin="12,2"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap">
                                <Run
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource BigFontSize}"
                                    Text="" />
                                <Run Text="{Binding VisualMedia.Media.MediaType, Converter={StaticResource MediaTypeConverter}}" />
                            </TextBlock>
                            <Grid
                                Background="LemonChiffon"
                                Opacity="0"
                                Tapped="VisualMediaTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="LocationMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Location" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        Width="205.5"
                        MaxHeight="168"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="#FF252525"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="45" Margin="5,0,5,0">
                            <TextBlock
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                DataContext="{Binding LocationMedia.Name}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}" />


                        </Grid>
                        <GridView
                            Grid.Row="1"
                            IsItemClickEnabled="False"
                            ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                            ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                            ItemsSource="{Binding PreviewMedias}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.HorizontalScrollMode="Disabled"
                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid
                            Grid.RowSpan="3"
                            Background="AliceBlue"
                            Opacity="0"
                            Tapped="ProfileGridTapped" />
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="ReelShareMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="5,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Converter={StaticResource ReelShareConverter}}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid
                                Grid.Row="1"
                                MinWidth="240"
                                MinHeight="50"
                                MaxWidth="320"
                                MaxHeight="360"
                                Margin="5"
                                BorderBrush="#FF252525"
                                BorderThickness="1"
                                CornerRadius="25">

                                <controls:ImageEx
                                    Grid.Row="1"
                                    MinHeight="300"
                                    Stretch="Uniform"
                                    Tapped="ReelShareImageExTapped">
                                    <controls:ImageEx.Source>
                                        <BitmapImage UriSource="{Binding ReelShareMedia.Media.Images[0].Uri}" />
                                    </controls:ImageEx.Source>
                                </controls:ImageEx>
                            </Grid>
                            <Grid
                                Grid.Row="2"
                                MinHeight="50"
                                MaxWidth="320"
                                Margin="5"
                                HorizontalAlignment="Left"
                                Background="#FF1D1C1C"
                                BorderBrush="#FF252525"
                                BorderThickness="1"
                                CornerRadius="25"
                                Visibility="{Binding ReelShareMedia.Text, Converter={StaticResource NullableToVisibilityConverter}}">
                                <TextBlock
                                    Margin="15,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding ReelShareMedia.Text}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="White"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap" />
                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="EmptyReelShareMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MaxWidth="360">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="5,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Converter={StaticResource ReelShareConverter}}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid
                                Grid.Row="1"
                                MinHeight="45"
                                MaxWidth="360"
                                Margin="5"
                                Background="#FF1D1C1C"
                                BorderBrush="#FF252525"
                                BorderThickness="1"
                                CornerRadius="25"
                                Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}">
                                <TextBlock
                                    Margin="15,2"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="White"
                                    Text="{Binding ReelShareMedia.Text}"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap" />
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="HashtagMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Hashtag" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        Width="205.5"
                        MaxHeight="168"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="#FF252525"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="45" Margin="5,0,5,0">
                            <TextBlock
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                Text="{Binding HashtagMedia.Name, Converter={StaticResource AddHashtagToStringConverter}}" />
                        </Grid>
                        <GridView
                            Grid.Row="1"
                            IsItemClickEnabled="False"
                            ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                            ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                            ItemsSource="{Binding PreviewMedias}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.HorizontalScrollMode="Disabled"
                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid
                            Grid.RowSpan="3"
                            Background="AliceBlue"
                            Opacity="0"
                            Tapped="ProfileGridTapped" />
                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="VoiceMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        MinWidth="80"
                        MaxHeight="75"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="#FF252525"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid
                            Height="60"
                            Margin="5,0,5,0"
                            DataContext="{Binding}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <AppBarButton
                                x:Name="PlayPauseButton"
                                VerticalAlignment="Center"
                                Click="PlayPauseButtonClick"
                                Content=""
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource BigBigFontSize}"
                                Foreground="{StaticResource DefaultForegroundColor}"
                                Tag="{Binding ItemId}" />
                            <Grid
                                Grid.Column="1"
                                Height="60"
                                MinWidth="70"
                                MaxWidth="160"
                                DataContext="{Binding}"
                                DataContextChanged="VoiceMediaGridDataContextChanged" />

                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="LinkMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Url" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinWidth="210"
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding LinkMedia.Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="White"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Rectangle Height="1" Fill="#FF252525" />
                                <controls:ImageEx
                                    Grid.Row="1"
                                    Height="155"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Visibility="{Binding LinkMedia.LinkContext.LinkImageUrl, Converter={StaticResource NullableToVisibilityConverter}}">
                                    <controls:ImageEx.Background>
                                        <ImageBrush Stretch="Fill">
                                            <ImageBrush.ImageSource>
                                                <BitmapImage UriSource="{Binding LinkMedia.LinkContext.LinkImageUrl}" />
                                            </ImageBrush.ImageSource>
                                        </ImageBrush>
                                    </controls:ImageEx.Background>
                                </controls:ImageEx>
                                <TextBlock
                                    Grid.Row="2"
                                    Margin="18,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding LinkMedia.LinkContext.LinkTitle}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="White"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                                <TextBlock
                                    Grid.Row="3"
                                    Margin="18,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding LinkMedia.LinkContext.LinkSummary}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource TinyFontSize}"
                                    Foreground="#FFA6A6A6"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                                <TextBlock
                                    Grid.Row="4"
                                    Margin="18,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding LinkMedia.LinkContext.LinkUrl}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource TinyFontSize}"
                                    Foreground="#FFA6A6A6"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                            </Grid>
                            <Grid
                                Grid.RowSpan="2"
                                Background="AliceBlue"
                                Opacity="0"
                                Tapped="LinkMediaGridTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="LiveViewerInviteTemplate">
                <Grid IsHoldingEnabled="True" IsRightTapEnabled="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MaxWidth="340">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Rectangle
                                Width="2"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Fill="#FF252525" />
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Margin="5,2"
                                        VerticalAlignment="Center"
                                        DataContext="{Binding LiveViewerInvite.Title}"
                                        DataContextChanged="TextBlockDataContextChanged"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="White"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="5,2"
                                        VerticalAlignment="Center"
                                        DataContext="{Binding LiveViewerInvite.Message}"
                                        DataContextChanged="TextBlockDataContextChanged"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="White"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />
                                </Grid>

                                <Grid
                                    Grid.Row="1"
                                    Height="360"
                                    MinWidth="240"
                                    MinHeight="50"
                                    MaxWidth="340"
                                    Margin="5"
                                    BorderBrush="#FF252525"
                                    BorderThickness="1"
                                    CornerRadius="25"
                                    Visibility="{Binding LiveViewerInvite.Broadcast, Converter={StaticResource NullableToVisibilityConverter}}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid>
                                        <controls:ImageEx HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <controls:ImageEx.Background>
                                                <ImageBrush Stretch="Fill">
                                                    <ImageBrush.ImageSource>
                                                        <BitmapImage UriSource="{Binding LiveViewerInvite.Broadcast.CoverFrameUrl}" />
                                                    </ImageBrush.ImageSource>
                                                </ImageBrush>
                                            </controls:ImageEx.Background>
                                        </controls:ImageEx>
                                        <Grid
                                            Height="60"
                                            Margin="5,0,5,0"
                                            VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50" />
                                                <ColumnDefinition Width="3" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Ellipse
                                                Grid.Column="0"
                                                Width="45"
                                                Height="45"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                StrokeThickness="0">
                                                <Ellipse.Fill>
                                                    <ImageBrush ImageSource="{Binding LiveViewerInvite.Broadcast.BroadcastOwner.ProfilePicture}" />
                                                </Ellipse.Fill>
                                            </Ellipse>
                                            <TextBlock
                                                Grid.Column="2"
                                                Margin="0,8,0,8"
                                                VerticalAlignment="Center"
                                                FontFamily="{StaticResource VazirFont}"
                                                FontSize="{StaticResource TinyFontSize}"
                                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                                Text="{Binding LiveViewerInvite.Broadcast.BroadcastOwner.UserName}" />

                                            <Grid
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                CornerRadius="5">
                                                <Grid.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                        <GradientStop Color="#FFC80082" />
                                                        <GradientStop Offset="1" Color="#FFDF0041" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>
                                                <TextBlock
                                                    Grid.Column="2"
                                                    Margin="4,2"
                                                    VerticalAlignment="Center"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource TinyFontSize}"
                                                    Foreground="White"
                                                    Text="LIVE" />
                                            </Grid>
                                            <Grid
                                                Grid.Row="1"
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                CornerRadius="5">
                                                <Grid.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                        <GradientStop Color="#FFC80082" />
                                                        <GradientStop Offset="1" Color="#FFDF0041" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>
                                                <!--<TextBlock Foreground="White"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           Grid.Column="2"
                                           VerticalAlignment="Center"
                                           Margin="4 2">
                                    <Run FontFamily="{StaticResource SymbolFont}"
                                         FontSize="{StaticResource TinyFontSize}"
                                         Text="" />
                                </TextBlock>-->

                                            </Grid>
                                        </Grid>

                                    </Grid>
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="6"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource DefaultFontSize}"
                                        Foreground="White"
                                        Text="Watch Live Video"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />
                                </Grid>

                            </Grid>
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="VideoCallEventTemplate">
                <Grid HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid
                        MinHeight="50"
                        MaxWidth="360"
                        Margin="5">

                        <TextBlock
                            Margin="15,2"
                            VerticalAlignment="Center"
                            DataContext="{Binding VideoCallEvent.Description}"
                            DataContextChanged="TextBlockDataContextChanged"
                            FontFamily="{StaticResource VazirFont}"
                            FontSize="{StaticResource TinyFontSize}"
                            Foreground="#FFCDCDCD"
                            TextAlignment="DetectFromContent"
                            TextWrapping="Wrap" />
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="AnimatedMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            Width="{Binding AnimatedMedia.Media.Width}"
                            Height="{Binding AnimatedMedia.Media.Height}"
                            MinWidth="100"
                            MinHeight="185"
                            MaxWidth="390"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">
                            <!--<controls:ImageEx HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch">
                            <controls:ImageEx.Background>
                                <ImageBrush Stretch="Fill">
                                    <ImageBrush.ImageSource>
                                        <BitmapImage UriSource="{Binding AnimatedMedia.Media.Url}"
                                                     ImageOpened="AnimatedMediaImageOpened"/>
                                    </ImageBrush.ImageSource>
                                </ImageBrush>
                            </controls:ImageEx.Background>
                        </controls:ImageEx>-->

                            <!--<Image Grid.Row="0"
                                   Stretch="None"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   gif:AnimationBehavior.AutoStart="True"
                                   gif:AnimationBehavior.RepeatBehavior="Forever"
                                   gif:AnimationBehavior.SourceUri="{Binding AnimatedMedia.Media.Url, Converter={StaticResource StringToUriConverter}}" />-->
                            <MediaElement
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                AreTransportControlsEnabled="False"
                                AutoPlay="False"
                                Source="{Binding AnimatedMedia.Media.Mp4Url, Converter={StaticResource StringToUriConverter}}"
                                Stretch="Uniform"
                                Tapped="MediaElementTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="ActionLogTemplate">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="#FF252525"
                            BorderThickness="1"
                            CornerRadius="25">

                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding ActionLog.Description}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="#FFCDCDCD"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Name="ProfileGridViewTemplate">
                <controls:ImageEx
                    Width="65"
                    Height="65"
                    Stretch="UniformToFill">
                    <controls:ImageEx.Source>
                        <BitmapImage UriSource="{Binding Images[0].Uri}" />
                    </controls:ImageEx.Source>
                </controls:ImageEx>
            </DataTemplate>

        </ResourceDictionary>
    </Page.Resources>
    <Grid Background="{StaticResource DefaultBackgroundColor}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <MediaElement
            x:Name="ME"
            AutoPlay="False"
            MediaEnded="MEMediaEnded"
            MediaFailed="MEMediaFailed"
            MediaOpened="MEMediaOpened"
            Opacity="0" />

        <ListView
            x:Name="ItemsLV"
            Grid.Row="1"
            Margin="5"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            Foreground="{StaticResource DefaultInnerForegroundColor}"
            IsItemClickEnabled="False"
            ItemTemplateSelector="{StaticResource ThreadItemTemplateSelector}"
            ItemsSource="{Binding Items, Mode=OneWay}"
            SelectionMode="None">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="VerticalContentAlignment" Value="Stretch" />
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Margin" Value="2" />
                    <Setter Property="Padding" Value="0" />
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Rectangle
                Grid.ColumnSpan="3"
                Height="1.5"
                Margin="15,2.5"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Fill="#FF363636" />
            <Grid Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />

                    </Grid.RowDefinitions>
                    <Ellipse
                        x:Name="UserImage"
                        Width="48"
                        Height="48"
                        Margin="4"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Bottom"
                        StrokeThickness="0"
                        Tapped="UserImageTapped" />
                    <TextBlock
                        x:Name="UsernameText"
                        Grid.Row="1"
                        Margin="8"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontFamily="{StaticResource VazirFont}"
                        FontSize="{StaticResource DefaultFontSize}"
                        Foreground="#FFA6A6A6"
                        Text=""
                        TextAlignment="Center"
                        TextWrapping="Wrap" />
                    <TextBlock
                        x:Name="UserInfoText"
                        Grid.Row="2"
                        Margin="8"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontFamily="{StaticResource VazirFont}"
                        FontSize="{StaticResource TinyTinyFontSize}"
                        Foreground="#FFA6A6A6"
                        Text=""
                        TextAlignment="Center"
                        TextWrapping="Wrap" />
                </Grid>
                <TextBlock
                    Grid.Row="1"
                    Margin="14"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontFamily="{StaticResource VazirFont}"
                    FontSize="{StaticResource TinyFontSize}"
                    Foreground="#FFA6A6A6"
                    TextAlignment="Center"
                    TextWrapping="Wrap">
                    Do you want to let<Run x:Name="RunUser" />
                    send you messages from now on? They'll only know you've seen their requests if you choose Accept.</TextBlock>
            </Grid>
        </Grid>
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Rectangle
                Height="1.5"
                Margin="15,2.5"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Fill="#FF363636" />
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <ToggleButton
                    x:Name="BlockSingleToggleButton"
                    Grid.Column="0"
                    Height="42"
                    Margin="5,0"
                    HorizontalContentAlignment="Center"
                    Background="Transparent"
                    Click="BlockSingleToggleButtonClick"
                    Content="Block"
                    FontFamily="{StaticResource VazirFont}"
                    FontSize="{StaticResource DefaultFontSize}"
                    Foreground="#FFFF2727"
                    Style="{StaticResource HeaderToggleButtonRemovedIconStyle}" />

                <Rectangle
                    Grid.Column="1"
                    Width="1.5"
                    Margin="3,8"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Fill="#FF363636" />
                <ToggleButton
                    x:Name="DeleteSingleToggleButton"
                    Grid.Column="2"
                    Height="42"
                    Margin="5,0"
                    HorizontalContentAlignment="Center"
                    Background="Transparent"
                    Click="DeleteSingleToggleButtonClick"
                    Content="Delete"
                    FontFamily="{StaticResource VazirFont}"
                    FontSize="{StaticResource DefaultFontSize}"
                    Foreground="#FFFF6C6C"
                    Style="{StaticResource HeaderToggleButtonRemovedIconStyle}" />
                <Rectangle
                    Grid.Column="3"
                    Width="1.5"
                    Margin="3,8"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Fill="#FF363636" />
                <ToggleButton
                    x:Name="AcceptSingleToggleButton"
                    Grid.Column="4"
                    Height="42"
                    Margin="5,0"
                    HorizontalContentAlignment="Center"
                    Background="Transparent"
                    Click="AcceptSingleToggleButtonClick"
                    Content="Accept"
                    FontFamily="{StaticResource VazirFont}"
                    FontSize="{StaticResource DefaultFontSize}"
                    Foreground="#FF34C08B"
                    Style="{StaticResource HeaderToggleButtonRemovedIconStyle}" />
            </Grid>
        </Grid>
    </Grid>
</Page>
