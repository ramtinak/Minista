<Page
    x:Class="Minista.Views.Direct.ThreadView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behaviors="using:Minista.Behaviors"
    xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:converters="using:Minista.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:gif="using:XamlAnimatedGif"
    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:loading="using:Minista.UserControls"
    xmlns:local="using:Minista"
    xmlns:localControls="using:Minista.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ministaUc="using:Minista.Controls"
    xmlns:selector="using:Minista.Selectors"
    xmlns:uc="using:Minista.UserControls.Direct"
    xmlns:vm="using:Minista.ViewModels.Direct"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    NavigationCacheMode="Enabled"
    mc:Ignorable="d">
    <Page.Resources>
        <ResourceDictionary>
            <Style x:Key="GridViewItemContainerStyle" TargetType="GridViewItem">
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                <Setter Property="VerticalAlignment" Value="Stretch" />
                <Setter Property="Margin" Value="1" />
                <Setter Property="Padding" Value="0" />
            </Style>

            <Style x:Key="SplitViewTogglePaneButtonStyle2" TargetType="ToggleButton">
                <Setter Property="FontSize" Value="20" />
                <Setter Property="FontFamily" Value="{ThemeResource SymbolThemeFontFamily}" />
                <Setter Property="MinHeight" Value="48" />
                <Setter Property="MinWidth" Value="48" />
                <Setter Property="Margin" Value="0" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="VerticalAlignment" Value="Top" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="Background" Value="Transparent" />
                <Setter Property="Foreground" Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                <Setter Property="Content" Value="&#xE700;" />
                <Setter Property="AutomationProperties.Name" Value="Menu" />
                <Setter Property="UseSystemFocusVisuals" Value="True" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToggleButton">
                            <Grid x:Name="LayoutRoot" Background="{TemplateBinding Background}">
                                <ContentPresenter
                                    x:Name="ContentPresenter"
                                    Margin="{TemplateBinding Padding}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    AutomationProperties.AccessibilityView="Raw"
                                    Content="{TemplateBinding Content}" />
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup x:Name="CommonStates">
                                        <VisualState x:Name="Normal" />
                                        <VisualState x:Name="PointerOver">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot" Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Pressed">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot" Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Disabled">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="(TextBlock.Foreground)">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlDisabledBaseLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="Checked" />
                                        <VisualState x:Name="CheckedPointerOver">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot" Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="CheckedPressed">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="LayoutRoot" Storyboard.TargetProperty="(Grid.Background)">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                        <VisualState x:Name="CheckedDisabled">
                                            <Storyboard>
                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="(TextBlock.Foreground)">
                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlDisabledBaseLowBrush}" />
                                                </ObjectAnimationUsingKeyFrames>
                                            </Storyboard>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <converters:DirectItemHorizontalConverter x:Name="DirectItemHorizontalConverter" />
            <converters:StoryShareTitleConverter x:Name="StoryShareTitleConverter" />
            <converters:MediaTypeConverter x:Name="MediaTypeConverter" />
            <converters:ReelShareConverter x:Name="ReelShareConverter" />
            <converters:NullableToVisibilityConverter x:Name="NullableToVisibilityConverter" />
            <converters:DirectLinkImageConverter x:Name="DirectLinkImageConverter" />
            <converters:NumericToSeparatorConverter x:Name="NumericToSeparatorConverter" />
            <converters:AddHashtagToStringConverter x:Name="AddHashtagToStringConverter" />
            <converters:StringToUriConverter x:Name="StringToUriConverter" />
            <converters:DirectMediaShareConverter x:Name="DirectMediaShareConverter" />
            <converters:DoubleToVisibilityConverter x:Name="DoubleToVisibilityConverter" />
            <converters:DirectItemUserVisibilityConverter x:Name="DirectItemUserVisibilityConverter" />
            <converters:DirectItemUserProfilePictureConverter x:Name="DirectItemUserProfilePictureConverter" />
            <converters:ThreadItemBackgroundColorConverter x:Name="ThreadItemBackgroundColorConverter" />

            <converters:CommentColorConverter x:Key="CommentColorConverter" />
            <converters:CommentBooleanConverter x:Key="CommentBooleanConverter" />
            <converters:BooleanToVisibiltyConverter x:Key="BooleanToVisibiltyConverter" />
            <converters:MaterialHeartConverter x:Key="MaterialHeartConverter" />
            <converters:DirectItemDateTimeConverter x:Key="DirectItemDateTimeConverter" />
            <converters:DirectItemSendingMessageVisibilityConverter x:Key="DirectItemSendingMessageVisibilityConverter" />
            <converters:DirectItemSendingMessageColorConverter x:Key="DirectItemSendingMessageColorConverter" />
            <converters:DirectItemSendingMessageTikTextConverter x:Key="DirectItemSendingMessageTikTextConverter" />


            <selector:ThreadItemTemplateSelector
                x:Key="ThreadItemTemplateSelector"
                ActionLogTemplate="{StaticResource ActionLogTemplate}"
                AnimatedMediaTemplate="{StaticResource AnimatedMediaTemplate}"
                EmptyReelShareMediaTemplate="{StaticResource EmptyReelShareMediaTemplate}"
                EmptyStoryShareTemplate="{StaticResource EmptyStoryShareTemplate}"
                FelixShareTemplate="{StaticResource FelixShareTemplate}"
                HashtagMediaTemplate="{StaticResource HashtagMediaTemplate}"
                LikeTemplate="{StaticResource LikeTemplate}"
                LinkMediaTemplate="{StaticResource LinkMediaTemplate}"
                LiveViewerInviteTemplate="{StaticResource LiveViewerInviteTemplate}"
                LocationMediaTemplate="{StaticResource LocationMediaTemplate}"
                MediaShareTemplate="{StaticResource MediaShareTemplate}"
                MediaTemplate="{StaticResource MediaTemplate}"
                NoTemplate="{StaticResource NoTemplate}"
                NotSupportedTemplate="{StaticResource NotSupportedTemplate}"
                PlaceholderTemplate="{StaticResource PlaceholderTemplate}"
                ProfileTemplate="{StaticResource ProfileTemplate}"
                RavenMediaTemplate="{StaticResource RavenMediaTemplate}"
                ReelShareMediaTemplate="{StaticResource ReelShareMediaTemplate}"
                StoryShareTemplate="{StaticResource StoryShareTemplate}"
                TextTemplate="{StaticResource TextTemplate}"
                VideoCallEventTemplate="{StaticResource VideoCallEventTemplate}"
                VoiceMediaTemplate="{StaticResource VoiceMediaTemplate}" />

            <DataTemplate x:Key="LikeTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="35"
                                Foreground="{StaticResource DirectItemText2ForegroundColor}"
                                Text="{Binding Text}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="1" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="StoryShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            Height="360"
                            MinWidth="240"
                            MinHeight="50"
                            MaxWidth="340"
                            Margin="5"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Converter={StaticResource StoryShareTitleConverter}}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <controls:ImageEx
                                Grid.Row="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch">
                                <controls:ImageEx.Background>
                                    <ImageBrush Stretch="Fill">
                                        <ImageBrush.ImageSource>
                                            <BitmapImage UriSource="{Binding StoryShare.Media.Images[0].Uri}" />
                                        </ImageBrush.ImageSource>
                                    </ImageBrush>
                                </controls:ImageEx.Background>
                            </controls:ImageEx>
                            <Grid Grid.Row="2" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid
                                Grid.RowSpan="3"
                                Background="Cyan"
                                DataContext="{Binding}"
                                Opacity="0"
                                Tapped="StoryShareGridTapped" />
                        </Grid>

                    </Grid>

                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="EmptyStoryShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding StoryShare.Title}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding StoryShare.Message}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemText2ForegroundColor}"
                                Text="{Binding}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="2" HorizontalAlignment="Right">
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />
                            </Grid>
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NoTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">

                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemText2ForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="1" HorizontalAlignment="Right">
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="NotSupportedTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            Background="{StaticResource DirectItemPeopleBackgroundColor}"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                Text="This type of message is not supported yet"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="PlaceholderTemplate">
                <Grid IsHoldingEnabled="True" IsRightTapEnabled="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Placeholder.Title}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <TextBlock
                                Grid.Row="1"
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Placeholder.Message}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemText2ForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="2" HorizontalAlignment="Right">
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>

            </DataTemplate>
            <DataTemplate x:Key="TextTemplate">
                <Grid
                    x:Name="MainTextGrid"
                    Margin="10"
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.Resources>
                        <Storyboard x:Key="RepliedAnimation" x:Name="RepliedAnimationResource">
                            <DoubleAnimation
                                AutoReverse="True"
                                EnableDependentAnimation="True"
                                Storyboard.TargetName="MainTextGridBackgroundBrush"
                                Storyboard.TargetProperty="Opacity"
                                From="0"
                                To="0.7"
                                Duration="0:0:0.85" />
                        </Storyboard>
                    </Grid.Resources>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid
                        x:Name="MainTextGridBackgroundBrush"
                        Grid.RowSpan="2"
                        Grid.ColumnSpan="2"
                        Background="{StaticResource DirectItemSelfBackgroundColor}"
                        Opacity="0" />
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <!--  Background="#FF373737"  -->

                        <Grid
                            MinWidth="70"
                            MinHeight="60"
                            MaxWidth="275"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid
                                x:Name="RepliedToMessageGrid"
                                Margin="17,5,15,1"
                                Tapped="RepliedToMessageGridTapped"
                                Visibility="{Binding RepliedToMessage, Converter={StaticResource NullableToVisibilityConverter}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Rectangle
                                    Width="2.5"
                                    Margin="5,0"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Stretch"
                                    Fill="{StaticResource DirectItemTimeForegroundColor}" />
                                <Grid Grid.Column="1">
                                    <TextBlock
                                        Margin="0,1,5,1"
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                        Text="{Binding RepliedToMessage.Text}"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />

                                </Grid>
                            </Grid>
                            <TextBlock
                                Grid.Row="1"
                                Margin="15,1"
                                VerticalAlignment="Center"
                                DataContext="{Binding Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="2" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>
                        </Grid>

                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="MediaShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Caption" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                        BorderThickness="1"
                        CornerRadius="15"
                        DoubleTapped="MediaShareGridDoubleTapped"
                        Tapped="MediaShareGridTapped">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="60" Margin="5,0,5,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="3" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Ellipse
                                Grid.Column="0"
                                Width="45"
                                Height="45"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                StrokeThickness="0">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding MediaShare.User.ProfilePicture}" />
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock
                                Grid.Column="2"
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                Text="{Binding MediaShare.User.UserName}" />


                        </Grid>
                        <controls:ImageEx
                            Grid.Row="1"
                            MinHeight="90"
                            Stretch="Uniform"
                            Tapped="MediaShareImageExTapped">
                            <controls:ImageEx.Source>
                                <BitmapImage UriSource="{Binding MediaShare, Converter={StaticResource DirectMediaShareConverter}}" />
                            </controls:ImageEx.Source>
                        </controls:ImageEx>
                        <Grid Grid.Row="2" MaxHeight="65">
                            <TextBlock
                                Grid.Column="2"
                                Margin="5,2"
                                DataContext="{Binding MediaShare.Caption.Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}" />
                        </Grid>
                        <Grid Grid.Row="3" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                        <!--<ListView x:Name="LVReactionUsers"
                                  SelectionMode="None"
                                  Foreground="{StaticResource DirectItemTextForegroundColor}"
                                  Grid.Column="1"
                                  Margin="0"
                                  ScrollViewer.HorizontalScrollMode="Enabled"
                                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                  ScrollViewer.VerticalScrollMode="Disabled"
                                  ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                  IsItemClickEnabled="True">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Center" />
                                    <Setter Property="HorizontalAlignment"
                                            Value="Center" />
                                    <Setter Property="Margin"
                                            Value="0" />
                                    <Setter Property="Padding"
                                            Value="0" />
                                    <Setter Property="Width"
                                            Value="34" />
                                    <Setter Property="Height"
                                            Value="34" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <ItemsStackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Width="34">
                                        <Ellipse Height="30"
                                                 Width="30">
                                            <Ellipse.Fill>
                                                <ImageBrush>
                                                    <ImageBrush.ImageSource>
                                                        <BitmapImage UriSource="{Binding User.ProfilePicture}" />
                                                    </ImageBrush.ImageSource>
                                                </ImageBrush>
                                            </Ellipse.Fill>
                                        </Ellipse>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>

                        </ListView>-->

                    </Grid>
                </Grid>

            </DataTemplate>
            <DataTemplate x:Key="MediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <!--
                        Height="400"
                        Width="290"
                    -->
                    <Grid
                        Grid.Column="1"
                        MaxWidth="290"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <controls:ImageEx MinHeight="90" Stretch="Uniform">
                            <controls:ImageEx.Source>
                                <BitmapImage UriSource="{Binding Media.Images[0].Uri}" />
                            </controls:ImageEx.Source>
                        </controls:ImageEx>
                        <ProgressBar
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="{StaticResource DirectUploadProgressBackgroundColor}"
                            Foreground="{StaticResource DirectUploadProgressForegroundColor}"
                            Maximum="100"
                            RenderTransformOrigin="0.5,0.5"
                            Visibility="{Binding Media.Percentage, Converter={StaticResource DoubleToVisibilityConverter}}"
                            Value="{Binding Media.Percentage}">
                            <ProgressBar.RenderTransform>
                                <CompositeTransform Rotation="-90" />
                            </ProgressBar.RenderTransform>
                        </ProgressBar>
                        <ProgressRing
                            Width="85"
                            Height="85"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Foreground="{StaticResource DirectUploadProgressRingForegroundColor}"
                            IsActive="True"
                            Visibility="{Binding Media.Percentage, Converter={StaticResource DoubleToVisibilityConverter}}" />

                        <Grid Grid.Row="1" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid
                            Grid.RowSpan="2"
                            Background="DodgerBlue"
                            Opacity="0"
                            Tapped="MediaImageExTapped" />
                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,0"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="ProfileTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Profile" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        Width="205.5"
                        MaxHeight="182"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="60" Margin="5,0,5,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition Width="3" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Ellipse
                                Grid.Column="0"
                                Width="45"
                                Height="45"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                StrokeThickness="0">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding ProfileMedia.ProfilePicture}" />
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock
                                Grid.Column="2"
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                Text="{Binding ProfileMedia.UserName}" />


                        </Grid>
                        <GridView
                            Grid.Row="1"
                            IsItemClickEnabled="False"
                            ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                            ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                            ItemsSource="{Binding PreviewMedias}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.HorizontalScrollMode="Disabled"
                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid Grid.Row="2" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid
                            Grid.RowSpan="3"
                            Background="AliceBlue"
                            Opacity="0"
                            Tapped="ProfileGridTapped" />
                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="FelixShareTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Caption" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MaxWidth="300"
                            Margin="5"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <controls:ImageEx MinHeight="90" Stretch="Uniform">
                                <controls:ImageEx.Source>
                                    <BitmapImage UriSource="{Binding FelixShareMedia.Images[0].Uri}" />
                                </controls:ImageEx.Source>
                            </controls:ImageEx>
                            <Grid VerticalAlignment="Bottom">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" MaxHeight="75" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <controls:DropShadowPanel
                                    Margin="15,2"
                                    BlurRadius="15.0"
                                    OffsetX="5.0"
                                    OffsetY="5.0"
                                    ShadowOpacity="0.70"
                                    Color="Black">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="{StaticResource DirectItemTextForegroundColor}"
                                        Text="{Binding FelixShareMedia.Title}"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />

                                </controls:DropShadowPanel>


                                <Grid
                                    Grid.Row="1"
                                    Height="60"
                                    Margin="5,0,5,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50" />
                                        <ColumnDefinition Width="3" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Ellipse
                                        Grid.Column="0"
                                        Width="45"
                                        Height="45"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        StrokeThickness="0">
                                        <Ellipse.Fill>
                                            <ImageBrush ImageSource="{Binding FelixShareMedia.User.ProfilePicture}" />
                                        </Ellipse.Fill>
                                    </Ellipse>
                                    <controls:DropShadowPanel
                                        Grid.Column="2"
                                        BlurRadius="15.0"
                                        OffsetX="5.0"
                                        OffsetY="5.0"
                                        ShadowOpacity="0.70"
                                        Color="Black">
                                        <TextBlock
                                            Margin="0,8,0,8"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource VazirFont}"
                                            FontSize="{StaticResource TinyFontSize}"
                                            Foreground="{StaticResource DirectItemTextForegroundColor}"
                                            Text="{Binding FelixShareMedia.User.UserName}" />
                                    </controls:DropShadowPanel>

                                </Grid>

                            </Grid>
                            <Grid Grid.Row="1" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid
                                Grid.RowSpan="4"
                                Background="AliceBlue"
                                Opacity="0"
                                Tapped="FelixShareGridTapped" />
                        </Grid>

                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="RavenMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="45"
                            MaxWidth="360"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1.5"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="12,2"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap">
                                <Run
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource BigFontSize}"
                                    Text="" />
                                <Run Text="{Binding VisualMedia.Media.MediaType, Converter={StaticResource MediaTypeConverter}}" />
                            </TextBlock>
                            <Grid Grid.Row="1" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid
                                Background="LemonChiffon"
                                Opacity="0"
                                Tapped="VisualMediaTapped" />
                        </Grid>

                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="LocationMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Location" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        Width="205.5"
                        MaxHeight="168"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="45" Margin="5,0,5,0">
                            <TextBlock
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                DataContext="{Binding LocationMedia.Name}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}" />


                        </Grid>
                        <GridView
                            Grid.Row="1"
                            IsItemClickEnabled="False"
                            ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                            ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                            ItemsSource="{Binding PreviewMedias}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.HorizontalScrollMode="Disabled"
                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid Grid.Row="2" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid
                            Grid.RowSpan="3"
                            Background="AliceBlue"
                            Opacity="0"
                            Tapped="ProfileGridTapped" />
                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="ReelShareMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Text" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="5,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Converter={StaticResource ReelShareConverter}}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid
                                Grid.Row="1"
                                MinWidth="240"
                                MinHeight="50"
                                MaxWidth="320"
                                MaxHeight="360"
                                Margin="5"
                                BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                                BorderThickness="1"
                                CornerRadius="25">

                                <controls:ImageEx
                                    Grid.Row="1"
                                    MinHeight="300"
                                    Stretch="Uniform"
                                    Tapped="ReelShareImageExTapped">
                                    <controls:ImageEx.Source>
                                        <BitmapImage UriSource="{Binding ReelShareMedia.Media.Images[0].Uri}" />
                                    </controls:ImageEx.Source>
                                </controls:ImageEx>
                            </Grid>
                            <Grid
                                Grid.Row="2"
                                MinHeight="50"
                                MaxWidth="320"
                                Margin="5"
                                HorizontalAlignment="Left"
                                Background="{StaticResource DirectItemPeopleBackgroundColor}"
                                BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                                BorderThickness="1"
                                CornerRadius="25"
                                Visibility="{Binding ReelShareMedia.Text, Converter={StaticResource NullableToVisibilityConverter}}">
                                <TextBlock
                                    Margin="15,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding ReelShareMedia.Text}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DirectItemTextForegroundColor}"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap" />
                            </Grid>
                            <Grid Grid.Row="3" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                        </Grid>
                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="EmptyReelShareMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MaxWidth="360">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="5,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding Converter={StaticResource ReelShareConverter}}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid
                                Grid.Row="1"
                                MinHeight="45"
                                MaxWidth="360"
                                Margin="5"
                                Background="{StaticResource DirectItemPeopleBackgroundColor}"
                                BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                                BorderThickness="1"
                                CornerRadius="25"
                                Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}">
                                <TextBlock
                                    Margin="15,2"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DirectItemTextForegroundColor}"
                                    Text="{Binding ReelShareMedia.Text}"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap" />
                            </Grid>
                            <Grid Grid.Row="2" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="HashtagMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Hashtag" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        Width="205.5"
                        MaxHeight="168"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid Height="45" Margin="5,0,5,0">
                            <TextBlock
                                Margin="0,8,0,8"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                Text="{Binding HashtagMedia.Name, Converter={StaticResource AddHashtagToStringConverter}}" />
                        </Grid>
                        <GridView
                            Grid.Row="1"
                            IsItemClickEnabled="False"
                            ItemContainerStyle="{StaticResource GridViewItemContainerStyle}"
                            ItemTemplate="{StaticResource ProfileGridViewTemplate}"
                            ItemsSource="{Binding PreviewMedias}"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                            ScrollViewer.HorizontalScrollMode="Disabled"
                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <GridView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition />
                                </TransitionCollection>
                            </GridView.ItemContainerTransitions>

                        </GridView>
                        <Grid Grid.Row="2" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                        <Grid
                            Grid.RowSpan="3"
                            Background="AliceBlue"
                            Opacity="0"
                            Tapped="ProfileGridTapped" />
                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="VoiceMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid
                        Grid.Column="1"
                        MinWidth="80"
                        MaxHeight="75"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                        BorderThickness="1"
                        CornerRadius="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid
                            Height="42"
                            Margin="5,0,5,0"
                            DataContext="{Binding}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <ToggleButton
                                x:Name="PlayPauseButton"
                                Width="40"
                                Height="40"
                                Margin="0,0,2,0"
                                VerticalAlignment="Center"
                                Background="Transparent"
                                Click="PlayPauseButtonClick"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                                Tag="" />
                            <!--<AppBarButton x:Name="PlayPauseButton"
                                          Foreground="{StaticResource DefaultForegroundColor}"
                                          Content=""
                                          Tag="{Binding ItemId}"
                                          VerticalAlignment="Center"
                                          FontFamily="{StaticResource MaterialSymbolFont}"
                                          FontSize="{StaticResource BigBigFontSize}"
                                          Click="PlayPauseButtonClick" />-->
                            <!--<Grid Grid.Column="1"
                                  DataContext="{Binding}"
                                  Height="60"
                                  MaxWidth="160"
                                  MinWidth="70"
                                  DataContextChanged="VoiceMediaGridDataContextChanged">

                            </Grid>-->
                            <ministaUc:ProgressVoice
                                x:Name="ProgressVoice"
                                Grid.Column="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center"
                                DataContext="{Binding}"
                                DataContextChanged="ProgressVoiceDataContextChanged"
                                Foreground="{StaticResource DirectVoiceProgressForegroundColor}" />

                        </Grid>
                        <Grid Grid.Row="2" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="LinkMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                            <MenuFlyoutItem
                                Click="CopyTextFlyoutClick"
                                DataContext="{Binding}"
                                Text="Copy Url" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinWidth="210"
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding LinkMedia.Text}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DirectItemTextForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Rectangle Height="1" Fill="{StaticResource DirectItemBorderBrushColor}" />
                                <controls:ImageEx
                                    Grid.Row="1"
                                    Height="155"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Visibility="{Binding LinkMedia.LinkContext.LinkImageUrl, Converter={StaticResource NullableToVisibilityConverter}}">
                                    <controls:ImageEx.Background>
                                        <ImageBrush Stretch="Fill">
                                            <ImageBrush.ImageSource>
                                                <BitmapImage UriSource="{Binding LinkMedia.LinkContext.LinkImageUrl}" />
                                            </ImageBrush.ImageSource>
                                        </ImageBrush>
                                    </controls:ImageEx.Background>
                                </controls:ImageEx>
                                <TextBlock
                                    Grid.Row="2"
                                    Margin="18,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding LinkMedia.LinkContext.LinkTitle}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DirectItemTextForegroundColor}"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                                <TextBlock
                                    Grid.Row="3"
                                    Margin="18,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding LinkMedia.LinkContext.LinkSummary}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource TinyFontSize}"
                                    Foreground="{StaticResource DirectLinkMediaForegroundColor}"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                                <TextBlock
                                    Grid.Row="4"
                                    Margin="18,2"
                                    VerticalAlignment="Center"
                                    DataContext="{Binding LinkMedia.LinkContext.LinkUrl}"
                                    DataContextChanged="TextBlockDataContextChanged"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource TinyFontSize}"
                                    Foreground="{StaticResource DirectLinkMediaForegroundColor}"
                                    TextAlignment="DetectFromContent"
                                    TextWrapping="Wrap"
                                    Visibility="{Binding Converter={StaticResource NullableToVisibilityConverter}}" />
                            </Grid>
                            <Grid Grid.Row="2" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                                <TextBlock
                                    Grid.Column="1"
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource TinyLargeFontSize}"
                                    Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                    TextWrapping="NoWrap"
                                    Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                            </Grid>

                            <Grid
                                Grid.RowSpan="3"
                                Background="AliceBlue"
                                Opacity="0"
                                Tapped="LinkMediaGridTapped" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>


            <DataTemplate x:Key="LiveViewerInviteTemplate">
                <Grid IsHoldingEnabled="True" IsRightTapEnabled="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid MaxWidth="340">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Rectangle
                                Width="2"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Fill="{StaticResource DirectItemBorderBrushColor}" />
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <TextBlock
                                        Margin="5,2"
                                        VerticalAlignment="Center"
                                        DataContext="{Binding LiveViewerInvite.Title}"
                                        DataContextChanged="TextBlockDataContextChanged"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="{StaticResource DirectItemTextForegroundColor}"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="5,2"
                                        VerticalAlignment="Center"
                                        DataContext="{Binding LiveViewerInvite.Message}"
                                        DataContextChanged="TextBlockDataContextChanged"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource TinyFontSize}"
                                        Foreground="{StaticResource DirectItemTextForegroundColor}"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />
                                </Grid>

                                <Grid
                                    Grid.Row="1"
                                    Height="360"
                                    MinWidth="240"
                                    MinHeight="50"
                                    MaxWidth="340"
                                    Margin="5"
                                    BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                                    BorderThickness="1"
                                    CornerRadius="25"
                                    Visibility="{Binding LiveViewerInvite.Broadcast, Converter={StaticResource NullableToVisibilityConverter}}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid>
                                        <controls:ImageEx HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <controls:ImageEx.Background>
                                                <ImageBrush Stretch="Fill">
                                                    <ImageBrush.ImageSource>
                                                        <BitmapImage UriSource="{Binding LiveViewerInvite.Broadcast.CoverFrameUrl}" />
                                                    </ImageBrush.ImageSource>
                                                </ImageBrush>
                                            </controls:ImageEx.Background>
                                        </controls:ImageEx>
                                        <Grid
                                            Height="60"
                                            Margin="5,0,5,0"
                                            VerticalAlignment="Top">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50" />
                                                <ColumnDefinition Width="3" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Ellipse
                                                Grid.Column="0"
                                                Width="45"
                                                Height="45"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                StrokeThickness="0">
                                                <Ellipse.Fill>
                                                    <ImageBrush ImageSource="{Binding LiveViewerInvite.Broadcast.BroadcastOwner.ProfilePicture}" />
                                                </Ellipse.Fill>
                                            </Ellipse>
                                            <TextBlock
                                                Grid.Column="2"
                                                Margin="0,8,0,8"
                                                VerticalAlignment="Center"
                                                FontFamily="{StaticResource VazirFont}"
                                                FontSize="{StaticResource TinyFontSize}"
                                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                                Text="{Binding LiveViewerInvite.Broadcast.BroadcastOwner.UserName}" />

                                            <Grid
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                CornerRadius="5">
                                                <Grid.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                        <GradientStop Color="#FFC80082" />
                                                        <GradientStop Offset="1" Color="#FFDF0041" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>
                                                <TextBlock
                                                    Grid.Column="2"
                                                    Margin="4,2"
                                                    VerticalAlignment="Center"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource TinyFontSize}"
                                                    Foreground="{StaticResource DirectItemTextForegroundColor}"
                                                    Text="LIVE" />
                                            </Grid>
                                            <Grid
                                                Grid.Row="1"
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                CornerRadius="5">
                                                <Grid.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                        <GradientStop Color="#FFC80082" />
                                                        <GradientStop Offset="1" Color="#FFDF0041" />
                                                    </LinearGradientBrush>
                                                </Grid.Background>
                                                <!--<TextBlock Foreground="{StaticResource DirectItemTextForegroundColor}"
                                           FontFamily="{StaticResource VazirFont}"
                                           FontSize="{StaticResource TinyFontSize}"
                                           Grid.Column="2"
                                           VerticalAlignment="Center"
                                           Margin="4 2">
                                    <Run FontFamily="{StaticResource SymbolFont}"
                                         FontSize="{StaticResource TinyFontSize}"
                                         Text="" />
                                </TextBlock>-->

                                            </Grid>
                                        </Grid>

                                    </Grid>
                                    <TextBlock
                                        Grid.Row="1"
                                        Margin="6"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource DefaultFontSize}"
                                        Foreground="{StaticResource DirectItemTextForegroundColor}"
                                        Text="Watch Live Video"
                                        TextAlignment="DetectFromContent"
                                        TextWrapping="Wrap" />
                                </Grid>
                                <Grid Grid.Row="2" HorizontalAlignment="Right">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock
                                        Margin="0,0,10,5"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="10.5"
                                        Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                        Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                        TextWrapping="NoWrap"
                                        ToolTipService.ToolTip="{Binding TimeStamp}" />

                                    <TextBlock
                                        Grid.Column="1"
                                        Margin="0,0,10,5"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Center"
                                        FontFamily="{StaticResource MaterialSymbolFont}"
                                        FontSize="{StaticResource TinyLargeFontSize}"
                                        Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                        Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                        TextWrapping="NoWrap"
                                        Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                                </Grid>

                            </Grid>
                        </Grid>

                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="40"
                            Height="40"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel Grid.Column="1" Orientation="Horizontal" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="VideoCallEventTemplate">
                <Grid HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid
                        MinHeight="50"
                        MaxWidth="360"
                        Margin="5">

                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock
                            Margin="15,2"
                            VerticalAlignment="Center"
                            DataContext="{Binding VideoCallEvent.Description}"
                            DataContextChanged="TextBlockDataContextChanged"
                            FontFamily="{StaticResource VazirFont}"
                            FontSize="{StaticResource TinyFontSize}"
                            Foreground="{StaticResource DirectItemText2ForegroundColor}"
                            TextAlignment="DetectFromContent"
                            TextWrapping="Wrap" />
                        <Grid Grid.Row="1" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>

                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="AnimatedMediaTemplate">
                <Grid
                    Holding="MenuGridHolding"
                    IsHoldingEnabled="True"
                    IsRightTapEnabled="True"
                    RightTapped="MenuGridRightTapped">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <FlyoutBase.AttachedFlyout>
                        <MenuFlyout Placement="Top">
                            <MenuFlyoutItem
                                Click="UnsendMessageFlyoutClick"
                                DataContext="{Binding}"
                                Text="Unsend Message" />
                        </MenuFlyout>
                    </FlyoutBase.AttachedFlyout>
                    <Grid Grid.RowSpan="2" Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid
                            Width="{Binding AnimatedMedia.Media.Width}"
                            Height="{Binding AnimatedMedia.Media.Height}"
                            MinWidth="100"
                            MinHeight="185"
                            MaxWidth="390"
                            Margin="5"
                            Background="{Binding Converter={StaticResource ThreadItemBackgroundColorConverter}}"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <!--<controls:ImageEx HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch">
                            <controls:ImageEx.Background>
                                <ImageBrush Stretch="Fill">
                                    <ImageBrush.ImageSource>
                                        <BitmapImage UriSource="{Binding AnimatedMedia.Media.Url}"
                                                     ImageOpened="AnimatedMediaImageOpened"/>
                                    </ImageBrush.ImageSource>
                                </ImageBrush>
                            </controls:ImageEx.Background>
                        </controls:ImageEx>-->

                            <!--<Image Grid.Row="0"
                                   Stretch="None"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   gif:AnimationBehavior.AutoStart="True"
                                   gif:AnimationBehavior.RepeatBehavior="Forever"
                                   gif:AnimationBehavior.SourceUri="{Binding AnimatedMedia.Media.Url, Converter={StaticResource StringToUriConverter}}" />-->
                            <MediaElement
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                AreTransportControlsEnabled="False"
                                AutoPlay="False"
                                Source="{Binding AnimatedMedia.Media.Mp4Url, Converter={StaticResource StringToUriConverter}}"
                                Stretch="Uniform"
                                Tapped="MediaElementTapped" />

                        </Grid>
                        <Grid
                            Grid.Row="1"
                            Grid.ColumnSpan="2"
                            HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="10.5"
                                Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                TextWrapping="NoWrap"
                                ToolTipService.ToolTip="{Binding TimeStamp}" />

                            <TextBlock
                                Grid.Column="1"
                                Margin="0,0,10,5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource MaterialSymbolFont}"
                                FontSize="{StaticResource TinyLargeFontSize}"
                                Foreground="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageColorConverter}, UpdateSourceTrigger=PropertyChanged}"
                                Text="{Binding SendingType, Converter={StaticResource DirectItemSendingMessageTikTextConverter}, UpdateSourceTrigger=PropertyChanged}"
                                TextWrapping="NoWrap"
                                Visibility="{Binding Converter={StaticResource DirectItemSendingMessageVisibilityConverter}}" />
                        </Grid>


                    </Grid>
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        MaxWidth="285"
                        Margin="5,-5,5,5"
                        HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}"
                        BorderThickness="0"
                        Visibility="{Binding Reactions.Visibility, Converter={StaticResource BooleanToVisibiltyConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ToggleButton
                            x:Name="LikeButton"
                            Width="36"
                            Height="35"
                            VerticalAlignment="Center"
                            Background="Transparent"
                            Click="LikeButtonClick"
                            DataContextChanged="LikeButtonDataContextChanged"
                            Foreground="{Binding Reactions.Liked, Converter={StaticResource CommentColorConverter}}"
                            Style="{StaticResource CenterHeaderToggleButtonWithoutIconStyle}"
                            Tag="{Binding Reactions.Liked, Converter={StaticResource MaterialHeartConverter}}">
                            <interactivity:Interaction.Behaviors>
                                <behaviors:PointersEvent />
                            </interactivity:Interaction.Behaviors>
                        </ToggleButton>
                        <StackPanel
                            Grid.Column="1"
                            Margin="2,0"
                            Orientation="Horizontal" />
                        <Grid
                            Grid.Column="1"
                            Margin="2,0"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="Black"
                            Opacity="0"
                            Tapped="LikedUsersGridTapped" />
                    </Grid>

                </Grid>
            </DataTemplate>

            <DataTemplate x:Key="ActionLogTemplate">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid Visibility="{Binding Converter={StaticResource DirectItemUserVisibilityConverter}}">
                        <Ellipse
                            Grid.Column="0"
                            Width="42"
                            Height="42"
                            Margin="10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            StrokeThickness="0"
                            Tapped="UserProfileEllipseTapped">
                            <Ellipse.Fill>
                                <ImageBrush ImageSource="{Binding Converter={StaticResource DirectItemUserProfilePictureConverter}}" />
                            </Ellipse.Fill>
                        </Ellipse>
                    </Grid>
                    <Grid Grid.Column="1" HorizontalAlignment="{Binding Converter={StaticResource DirectItemHorizontalConverter}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid
                            MinHeight="50"
                            MaxWidth="360"
                            Margin="5"
                            BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                            BorderThickness="1"
                            CornerRadius="25">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                Margin="15,2"
                                VerticalAlignment="Center"
                                DataContext="{Binding ActionLog.Description}"
                                DataContextChanged="TextBlockDataContextChanged"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource TinyFontSize}"
                                Foreground="{StaticResource DirectItemText2ForegroundColor}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />
                            <Grid Grid.Row="1" HorizontalAlignment="Right">
                                <TextBlock
                                    Margin="0,0,10,5"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="10.5"
                                    Foreground="{StaticResource DirectItemTimeForegroundColor}"
                                    Text="{Binding TimeStamp, Converter={StaticResource DirectItemDateTimeConverter}}"
                                    TextWrapping="NoWrap"
                                    ToolTipService.ToolTip="{Binding TimeStamp}" />

                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </DataTemplate>

            <DataTemplate x:Name="ProfileGridViewTemplate">
                <controls:ImageEx
                    Width="65"
                    Height="65"
                    Stretch="UniformToFill">
                    <controls:ImageEx.Source>
                        <BitmapImage UriSource="{Binding Images[0].Uri}" />
                    </controls:ImageEx.Source>
                </controls:ImageEx>
            </DataTemplate>

        </ResourceDictionary>
    </Page.Resources>
    <Page.DataContext>
        <vm:ThreadViewModel x:Name="ThreadVM" x:FieldModifier="public" />
    </Page.DataContext>
    <Grid Background="{StaticResource DefaultBackgroundColor}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <MediaElement
            x:Name="ME"
            AutoPlay="False"
            MediaEnded="MEMediaEnded"
            MediaFailed="MEMediaFailed"
            MediaOpened="MEMediaOpened"
            Opacity="0" />
        <SplitView
            x:Name="SplitView"
            CompactPaneLength="0"
            DisplayMode="CompactOverlay"
            Foreground="{StaticResource DefaultForegroundColor}"
            IsPaneOpen="False"
            IsTabStop="False"
            OpenPaneLength="240"
            PaneBackground="{StaticResource DirectPaneBackgroundColor}"
            PanePlacement="Right">
            <SplitView.Pane>
                <Grid
                    x:Name="UsersGrid"
                    Grid.RowSpan="2"
                    Grid.Column="1"
                    Width="240">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <!--<controls:GridSplitter Width="11"
                                   ResizeBehavior="BasedOnAlignment"
                                   ResizeDirection="Auto"
                                   Background="#FF343434"
                                   Foreground="{StaticResource DirectItemTextForegroundColor}"
                                   FontSize="13">
                <controls:GridSplitter.Element>
                    <Grid>
                        <TextBlock HorizontalAlignment="Center"
                                   IsHitTestVisible="False"
                                   VerticalAlignment="Center"
                                   Text="&#xE784;"
                                   Foreground="{StaticResource DirectItemTextForegroundColor}"
                                   FontFamily="Segoe MDL2 Assets">
                        </TextBlock>
                    </Grid>
                </controls:GridSplitter.Element>
            </controls:GridSplitter>-->
                    <!--<Grid Width="1"
                          Background="#FF212121"  Opacity="0"/>-->
                    <ScrollViewer Grid.Column="1">
                        <StackPanel>

                            <TextBox
                                x:Name="TextThreadTitle"
                                Grid.Column="1"
                                Margin="2,12,0,0"
                                VerticalAlignment="Center"
                                AcceptsReturn="True"
                                Background="{x:Null}"
                                BorderThickness="1"
                                FontFamily="{StaticResource VazirFont}"
                                FontSize="{StaticResource DefaultFontSize}"
                                Foreground="{StaticResource DefaultInnerForegroundColor}"
                                IsEnabled="False"
                                IsSpellCheckEnabled="False"
                                PlaceholderText="Thread title..."
                                Style="{StaticResource CommentTextBoxCenter}"
                                Text="{Binding CurrentThread.Title, Mode=TwoWay}"
                                TextAlignment="DetectFromContent"
                                TextWrapping="Wrap" />

                            <Grid
                                x:Name="ApprovalGrid"
                                Margin="0,5"
                                Visibility="{Binding ApprovalAdminVisibility, Mode=TwoWay}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="6,4"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DefaultInnerForegroundColor}"
                                    Text="Approval required to join"
                                    TextWrapping="Wrap" />
                                <ToggleSwitch
                                    x:Name="toggleApprovalGrid"
                                    Grid.Column="2"
                                    HorizontalAlignment="Right"
                                    Foreground="{StaticResource DefaultInnerForegroundColor}"
                                    OffContent="{x:Null}"
                                    OnContent=""
                                    Style="{StaticResource ToggleSwitchStyle}"
                                    Toggled="ToggleApprovalGridToggled" />
                            </Grid>
                            <Rectangle
                                Grid.Row="1"
                                Grid.ColumnSpan="3"
                                Height="1"
                                Margin="5,2.5"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Fill="{StaticResource SeperatorColor}" />
                            <Grid Grid.Column="1" Margin="6,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock
                                    Margin="2,10"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DefaultInnerForegroundColor}"
                                    Text="Members"
                                    TextWrapping="Wrap" />
                                <StackPanel
                                    x:Name="AddMemberStack"
                                    Grid.Row="2"
                                    Visibility="{Binding AddMemberVisibility}">

                                    <Rectangle
                                        Grid.Row="1"
                                        Grid.ColumnSpan="3"
                                        Height="1"
                                        Margin="15,2.5"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        Fill="{StaticResource SeperatorColor}" />
                                    <ToggleButton
                                        x:Name="AddPeopleToggleButton"
                                        Grid.Row="2"
                                        Margin="4,10"
                                        Background="Transparent"
                                        Click="AddPeopleToggleButtonButtonClick"
                                        Content="Add People..."
                                        FontFamily="{StaticResource VazirFont}"
                                        FontSize="{StaticResource DefaultFontSize}"
                                        Foreground="{StaticResource DefaultInnerForegroundColor}"
                                        Style="{StaticResource HeaderToggleButtonWithoutIconStyle}"
                                        Tag="" />
                                </StackPanel>
                                <Rectangle
                                    Grid.Row="3"
                                    Grid.ColumnSpan="3"
                                    Height="1"
                                    Margin="15,2.5"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Fill="{StaticResource SeperatorColor}" />
                                <ListView
                                    x:Name="UsersLV"
                                    Grid.Row="4"
                                    Margin="5"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch"
                                    Foreground="{StaticResource DefaultInnerForegroundColor}"
                                    IsItemClickEnabled="True"
                                    ItemClick="UsersLVItemClick"
                                    ItemTemplateSelector="{StaticResource ThreadItemTemplateSelector}"
                                    ItemsSource="{Binding Users, Mode=OneWay}"
                                    SelectionMode="None">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                            <Setter Property="Margin" Value="2" />
                                            <Setter Property="Padding" Value="0" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid Height="65" Margin="5,0,5,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="60" />
                                                        <ColumnDefinition Width="3" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Ellipse
                                                        Grid.Column="0"
                                                        Width="55"
                                                        Height="55"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        StrokeThickness="0">
                                                        <Ellipse.Fill>
                                                            <ImageBrush ImageSource="{Binding ProfilePicture}" />
                                                        </Ellipse.Fill>
                                                    </Ellipse>
                                                    <TextBlock
                                                        Grid.Column="2"
                                                        Margin="0,8,0,8"
                                                        VerticalAlignment="Center"
                                                        FontFamily="{StaticResource VazirFont}"
                                                        FontSize="{StaticResource TinyFontSize}"
                                                        Foreground="{StaticResource DefaultInnerForegroundColor}"
                                                        Text="{Binding UserName}" />


                                                </Grid>

                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>

                            </Grid>
                            <Rectangle
                                Grid.Row="1"
                                Grid.ColumnSpan="3"
                                Height="1.5"
                                Margin="5,2.5"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Fill="{StaticResource SeperatorColor}" />
                            <Grid
                                x:Name="LeaveChatGrid"
                                Margin="6,0"
                                Visibility="{Binding LeaveChatVisibility}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ToggleButton
                                    x:Name="LeaveChatToggleButton"
                                    Margin="6,10"
                                    Background="Transparent"
                                    Click="LeaveChatToggleButtonClick"
                                    Content="Leave chat"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource HeaderFontSize}"
                                    Foreground="{StaticResource DirectLeaveChatForegroundColor}"
                                    Style="{StaticResource HeaderToggleButtonRemovedIconStyle}"
                                    Tag="" />
                                <TextBlock
                                    Grid.Row="1"
                                    Margin="6,2"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource TinyFontSize}"
                                    FontStyle="Italic"
                                    Foreground="{StaticResource DefaultInnerForegroundColor}"
                                    Text="You won't receive messages from this group unless someone adds you to the conversation again."
                                    TextWrapping="Wrap" />
                            </Grid>

                            <Rectangle
                                Grid.Row="1"
                                Grid.ColumnSpan="3"
                                Height="1.5"
                                Margin="5,2.5"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Fill="{StaticResource SeperatorColor}" />
                            <Grid
                                x:Name="EndChatGrid"
                                Margin="6,0"
                                Visibility="{Binding EndChatVisibility}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ToggleButton
                                    x:Name="EndChatToggleButton"
                                    Margin="6,10"
                                    Background="Transparent"
                                    Click="EndChatToggleButtonClick"
                                    Content="End chat"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource HeaderFontSize}"
                                    Foreground="{StaticResource DirectLeaveChatForegroundColor}"
                                    Style="{StaticResource HeaderToggleButtonRemovedIconStyle}"
                                    Tag="" />
                                <TextBlock
                                    Grid.Row="1"
                                    Margin="6,2"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource TinyFontSize}"
                                    FontStyle="Italic"
                                    Foreground="{StaticResource DefaultInnerForegroundColor}"
                                    Text="All group members will be removed from this chat. They still will able to view the chat history."
                                    TextWrapping="Wrap" />
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>

            </SplitView.Pane>
            <SplitView.Content>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" MaxHeight="70" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Margin="12,8,5,2"
                            VerticalAlignment="Center"
                            FontFamily="{StaticResource VazirFont}"
                            FontSize="{StaticResource DefaultFontSize}"
                            Foreground="{StaticResource DefaultForegroundColor}"
                            Text="{Binding CurrentThread.Title, Mode=TwoWay}"
                            TextWrapping="Wrap" />
                        <TextBlock
                            Grid.Row="1"
                            Margin="16,2,5,2"
                            VerticalAlignment="Center"
                            FontFamily="{StaticResource VazirFont}"
                            FontSize="{StaticResource TinyFontSize}"
                            Foreground="{StaticResource DirectIsTypingForegroundColor}"
                            Text="{Binding TypingText, Mode=TwoWay}"
                            TextWrapping="Wrap"
                            Visibility="{Binding TypingVisibility, Mode=TwoWay}" />
                        <ToggleButton
                            x:Name="MenuButton"
                            Grid.RowSpan="2"
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            AutomationProperties.Name="Menu"
                            Click="MenuButtonClick"
                            Content="&#xE700;"
                            Foreground="{StaticResource DefaultForegroundColor}"
                            Style="{StaticResource SplitViewTogglePaneButtonStyle2}"
                            TabIndex="1" />
                        <!--    -->
                    </Grid>
                    <Rectangle
                        Grid.Row="1"
                        Grid.ColumnSpan="3"
                        Height="1"
                        Margin="10,2.5"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Fill="{StaticResource SeperatorColor}" />
                    <Grid Grid.Row="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <loading:LoadingUc
                            x:Name="TopLoading"
                            VerticalAlignment="Top"
                            Visibility="Collapsed" />
                        <ListView
                            x:Name="ItemsLV"
                            Grid.Row="1"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            x:FieldModifier="public"
                            Foreground="{StaticResource DefaultInnerForegroundColor}"
                            IsItemClickEnabled="False"
                            ItemTemplateSelector="{StaticResource ThreadItemTemplateSelector}"
                            ItemsSource="{Binding Items, Mode=OneWay}"
                            SelectionMode="None">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="VerticalContentAlignment" Value="Stretch" />
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="Margin" Value="2" />
                                    <Setter Property="Padding" Value="0" />
                                </Style>
                            </ListView.ItemContainerStyle>
                        </ListView>

                        <ListView
                            x:Name="LVGiphy"
                            Grid.Row="2"
                            Margin="14,0"
                            Foreground="{StaticResource DirectItemTextForegroundColor}"
                            IsItemClickEnabled="True"
                            ItemClick="LVGiphyItemClick"
                            ItemsSource="{Binding GiphsItems}"
                            ScrollViewer.HorizontalScrollBarVisibility="Auto"
                            ScrollViewer.HorizontalScrollMode="Enabled"
                            ScrollViewer.VerticalScrollBarVisibility="Hidden"
                            ScrollViewer.VerticalScrollMode="Disabled"
                            SelectionMode="None">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                                    <Setter Property="Margin" Value="0" />
                                    <Setter Property="Padding" Value="0,5,5,5" />
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <ItemsStackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ListView.ItemsPanel>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid
                                        Width="{Binding Images.FixedWidth.Width}"
                                        Height="135"
                                        Background="{StaticResource DirectItemPeopleBackgroundColor}"
                                        BorderBrush="{StaticResource DirectItemBorderBrushColor}"
                                        BorderThickness="1"
                                        CornerRadius="25">
                                        <Image
                                            HorizontalAlignment="Stretch"
                                            VerticalAlignment="Stretch"
                                            gif:AnimationBehavior.AutoStart="True"
                                            gif:AnimationBehavior.RepeatBehavior="Forever"
                                            gif:AnimationBehavior.SourceUri="{Binding Images.FixedWidth.Url, Converter={StaticResource StringToUriConverter}}"
                                            Stretch="Fill" />

                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>

                        </ListView>

                        <Grid Grid.Row="3">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <uc:RecordDirectVoiceUc
                                x:Name="RecordDirectVoiceUc"
                                x:FieldModifier="public"
                                Visibility="Collapsed" />
                            <Grid
                                Grid.Row="1"
                                MinHeight="50"
                                Margin="5,5,5,8"
                                BorderBrush="{StaticResource DirectTextBoxBorderColor}"
                                BorderThickness="1.8"
                                CornerRadius="25">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <AppBarButton
                                    x:Name="CameraButton"
                                    VerticalAlignment="Center"
                                    Click="CameraButtonClick"
                                    Content=""
                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                    FontSize="{StaticResource BigFontSize}"
                                    Foreground="{StaticResource DefaultForegroundColor}" />

                                <AppBarButton
                                    x:Name="SendButton"
                                    Grid.Column="2"
                                    Width="75"
                                    VerticalAlignment="Center"
                                    Click="SendButtonClick"
                                    Content="Send"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DefaultForegroundColor}"
                                    Visibility="Collapsed" />
                                <TextBox
                                    x:Name="TextMessage"
                                    Grid.Column="1"
                                    MaxHeight="150"
                                    Margin="1"
                                    VerticalAlignment="Center"
                                    AcceptsReturn="True"
                                    Background="{x:Null}"
                                    BorderThickness="0"
                                    FontFamily="{StaticResource VazirFont}"
                                    FontSize="{StaticResource DefaultFontSize}"
                                    Foreground="{StaticResource DirectItemTextForegroundColor}"
                                    IsSpellCheckEnabled="False"
                                    LostFocus="TextMessageLostFocus"
                                    PlaceholderText="Write a message..."
                                    Style="{StaticResource CommentTextBoxCenter}"
                                    TextAlignment="DetectFromContent"
                                    TextChanging="TextMessageTextChanging"
                                    TextWrapping="Wrap" />

                                <Border
                                    x:Name="RecordInfoBorder"
                                    Grid.Row="1"
                                    Grid.ColumnSpan="5"
                                    Margin="0,0,48,0"
                                    Background="{StaticResource DefaultBackgroundColor}"
                                    Visibility="Collapsed">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <StackPanel
                                            x:Name="ElapsedPanel"
                                            HorizontalAlignment="Left"
                                            Orientation="Horizontal"
                                            SizeChanged="ElapsedPanel_SizeChanged">
                                            <Ellipse
                                                Width="12"
                                                Height="12"
                                                Margin="12,0,8,0"
                                                Fill="{StaticResource DirectVoiceRecoderEllipseForegroundColor}" />
                                            <TextBlock
                                                x:Name="ElapsedLabel"
                                                Width="64"
                                                Margin="0,0,0,1"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource DirectVoiceRecoderTimeForegroundColor}"
                                                Text="0:00,00" />
                                        </StackPanel>
                                        <StackPanel
                                            x:Name="SlidePanel"
                                            Grid.Column="1"
                                            Margin="0,0,84,0"
                                            HorizontalAlignment="Right"
                                            Orientation="Horizontal"
                                            SizeChanged="SlidePanel_SizeChanged">
                                            <FontIcon
                                                Margin="0,1,4,0"
                                                FontSize="12"
                                                Foreground="{StaticResource DirectUploadProgressForegroundColor}"
                                                Glyph="&#xE00E;" />
                                            <TextBlock
                                                Margin="0,0,0,0"
                                                VerticalAlignment="Center"
                                                Foreground="{StaticResource DirectUploadProgressForegroundColor}"
                                                Style="{StaticResource CaptionTextBlockStyle}"
                                                Text="SLIDE TO CANCEL" />
                                        </StackPanel>


                                        <HyperlinkButton
                                            x:Name="ButtonCancelRecording"
                                            Grid.Row="1"
                                            Grid.ColumnSpan="4"
                                            HorizontalAlignment="Center"
                                            Click="ButtonCancelRecording_Click"
                                            Content="Cancel"
                                            Foreground="{StaticResource SystemControlHyperlinkTextBrush}"
                                            Visibility="Collapsed" />
                                    </Grid>
                                </Border>





                                <Grid
                                    x:Name="RightGrid"
                                    Grid.Column="2"
                                    VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>



                                    <!--<AppBarButton x:Name="VoiceButton"
                                                  Foreground="{StaticResource DefaultForegroundColor}"
                                                  Grid.Column="0"
                                                  Content=""
                                                  VerticalAlignment="Center"
                                                  FontFamily="{StaticResource MaterialSymbolFont}"
                                                  FontSize="{StaticResource BigFontSize}"
                                                  Click="VoiceButtonClick" />-->
                                    <AppBarButton
                                        x:Name="FileSelectButton"
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        Click="FileSelectButtonClick"
                                        Content="ﱩ"
                                        FontFamily="{StaticResource MaterialSymbolFont}"
                                        FontSize="{StaticResource BigBigFontSize}"
                                        Foreground="{StaticResource DefaultForegroundColor}" />
                                    <AppBarButton
                                        x:Name="PlusButton"
                                        Grid.Column="1"
                                        VerticalAlignment="Center"
                                        Click="PlusButtonClick"
                                        Content=""
                                        FontFamily="{StaticResource MaterialSymbolFont}"
                                        FontSize="{StaticResource BigFontSize}"
                                        Foreground="{StaticResource DefaultForegroundColor}">
                                        <AppBarButton.Flyout>
                                            <MenuFlyout Placement="Top">
                                                <MenuFlyoutItem
                                                    x:Name="GiphyMenuFlyoutItem"
                                                    Height="42"
                                                    HorizontalContentAlignment="Center"
                                                    Click="GiphyMenuFlyoutItemClick"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource BigFontSize}"
                                                    Text="Gif" />


                                                <MenuFlyoutItem
                                                    x:Name="HeartMenuFlyoutItem"
                                                    HorizontalContentAlignment="Center"
                                                    Click="HeartMenuFlyoutItemClick"
                                                    FontFamily="{StaticResource MaterialSymbolFont}"
                                                    FontSize="{StaticResource HeavyBigFontSize}"
                                                    Foreground="{StaticResource DirectHeartButtonForegroundColor}"
                                                    Text="" />
                                            </MenuFlyout>
                                        </AppBarButton.Flyout>
                                        <!--<FlyoutBase.AttachedFlyout>
                                <MenuFlyout Placement="Top" >
                                    <MenuFlyoutItem x:Name="GiphyMenuFlyoutItem"
                                                    Text="Gif"
                                                    Height="42"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource BigFontSize}"
                                                    Click="GiphyMenuFlyoutItemClick"
                                                    HorizontalAlignment="Center"
                                                    HorizontalContentAlignment="Center" />


                                    <MenuFlyoutItem x:Name="HeartMenuFlyoutItem"
                                                    Text="❤️"
                                                    Foreground="#FFE03939"
                                                    FontFamily="{StaticResource VazirFont}"
                                                    FontSize="{StaticResource BigFontSize}"
                                                    Click="HeartMenuFlyoutItemClick"
                                                    HorizontalAlignment="Center"
                                                    HorizontalContentAlignment="Center" />
                                </MenuFlyout>
                            </FlyoutBase.AttachedFlyout>-->

                                    </AppBarButton>


                                    <Grid
                                        x:Name="ButtonRecord"
                                        Grid.Column="2"
                                        Width="58"
                                        Height="52"
                                        VerticalAlignment="Bottom"
                                        Canvas.ZIndex="1000">
                                        <Border
                                            x:Name="Ellipse"
                                            Width="58"
                                            Height="52"
                                            Margin="0,0,-7,0"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Background="{StaticResource DirectHeartButtonForegroundColor}"
                                            Visibility="Collapsed" />
                                        <localControls:ChatRecordButton
                                            x:Name="btnVoiceMessage"
                                            AllowFocusOnInteraction="False"
                                            Background="{x:Null}"
                                            ManipulationDelta="VoiceButton_ManipulationDelta"
                                            ManipulationMode="TranslateX,TranslateY"
                                            RecordingLocked="VoiceButton_RecordingLocked"
                                            RecordingStarted="VoiceButton_RecordingStarted"
                                            RecordingStopped="VoiceButton_RecordingStopped" />
                                    </Grid>
                                </Grid>


                            </Grid>

                        </Grid>
                    </Grid>
                </Grid>
            </SplitView.Content>
        </SplitView>



        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="khar">

                <VisualState x:Name="VisualStateSecond">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="718" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="SplitView.DisplayMode" Value="CompactInline" />
                        <Setter Target="SplitView.IsPaneOpen" Value="True" />
                        <!--<Setter Target="UsersGrid.Visibility"
                                Value="Visible" />-->

                    </VisualState.Setters>
                </VisualState>
                <!--<VisualState x:Name="VisualStateDefault">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>

                    <VisualState.Setters>

                        <Setter Target="UsersGrid.Visibility"
                                Value="Collapsed" />

                    </VisualState.Setters>
                </VisualState>-->

            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>
